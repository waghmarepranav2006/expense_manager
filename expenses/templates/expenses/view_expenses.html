{% extends 'expenses/base.html' %}
{% block content %}
    <h2>My Expenses</h2>

    <form method="get" class="card">
        <div style="display: flex; align-items: center; gap: 1em; flex-wrap: wrap;">
            <div>
                <label>Category:</label>
                <select name="category">
                    <option value="">All</option>
                    {% for c in categories %}<option value="{{ c }}" {% if request.GET.category == c %}selected{% endif %}>{{ c }}</option>{% endfor %}
                </select>
            </div>
            <div>
                <label>Start Date:</label>
                <input type="date" name="start_date" value="{{ request.GET.start_date }}">
            </div>
            <div>
                <label>End Date:</label>
                <input type="date" name="end_date" value="{{ request.GET.end_date }}">
            </div>
            <div style="align-self: flex-end;">
                <button type="submit">Filter</button>
            </div>
        </div>
    </form>

    {% for expense in expenses %}
        <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h4>{{ expense.category }} - â‚¹{{ expense.amount }}</h4>
                    <p style="margin: 0; color: #6c757d;">{{ expense.date }}</p>
                    {% if expense.description %}<p style="margin-top: 0.5em;">{{ expense.description }}</p>{% endif %}
                </div>
                <div style="display: flex; gap: 0.5em;">
                    <a href="{% url 'edit_expense' expense.id %}" class="btn btn-sm btn-edit">Edit</a>
                    <a href="{% url 'delete_expense' expense.id %}" class="btn btn-sm btn-delete" onclick="return confirm('Are you sure you want to delete this expense?');">Delete</a>
                </div>
            </div>
        </div>
    {% empty %}
        <div class="card">
            <p>No expenses found. Add your first one!</p>
        </div>
    {% endfor %}
{% endblock %}
